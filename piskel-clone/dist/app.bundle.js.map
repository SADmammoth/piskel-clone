{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/screens/canvas/Tools/tool.js","webpack:///./src/screens/canvas/Tools/pen/index.js","webpack:///./src/screens/canvas/Tools/eraser/index.js","webpack:///./src/screens/canvas/Tools/bucket/bucket.js","webpack:///./src/screens/canvas/Tools/locator.js","webpack:///./src/screens/canvas/Tools/toolbarManager.js","webpack:///./src/screens/canvas/Tools/colorManager.js","webpack:///./src/screens/canvas/Tools/brushbarManager.js","webpack:///./src/components/frames-list/Frame.js","webpack:///./src/screens/canvas/Tools/canvasManager.js","webpack:///./src/components/layers-list/layersManager.js","webpack:///./src/components/layers-list/Layer.js","webpack:///./src/components/layers-list/layersList.js","webpack:///./src/components/layers-list/index.js","webpack:///./src/components/frames-list/framesManager.js","webpack:///./src/components/frames-list/index.js","webpack:///./src/components/frames-list/framesList.js","webpack:///./src/screens/preview/videoPreviewer.js","webpack:///./src/index.js","webpack:///./src/app.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Tool","constructor","this","is_Acting","manager","window","globalState","currentLayer","activateTool","event","startAction","invokeTool","invoke","currentTool","suspendTool","toolAction","intimeActions","suspend","deactivateTool","stopAction","Pen","super","clickAction","context","canvas","getContext","currentPath","Path2D","widthMod","brushWidth","paintColor","primaryColor","fillStyle","beginPath","paintPoint","paint","unit_size","prevX","center_pixel","d_x","prevY","d_y","fill","getPointedUnit","pageX","pageY","closePath","Eraser","globalCompositeOperation","Bucket","[object Object]","x","secondaryColor","start","color","getColor","fn","args","result","trampoline","rec","plus","length","Error","reduce","acc","arr1","arr2","forEach","arr","a","inthe","push","addThatNotIn","get_plus","setTimeout","console","log","Array","of","locator","reactEvent","pointedUnit","drawLocation","XY","$","text","unitX","unitY","noLocation","toolbarManager","toolsObject","updateView","updatePreview","mouseup","blur","on","delegate","signal","update","reload","tool","off","e","stopImmediatePropagation","target","getAttribute","removeClass","classList","add","colorManager","default_primary","default_secondary","style","backgroundColor","buf","brushbarManager","default_width","clearTimeout","timeout","css","Frame","count","layerList","copy","html","node","previewTemplate","prepend","preview","find","redraw","canvasManager","width","height","unit_width","unit_height","constructCanvas","fillRect","canvasTemplate","drawImage","eq","remove","getCanvasPoint","canvasX","canvasY","rect","getBoundingClientRect","left","top","findUnit","Math","floor","getUnit","canvasUnit","locateUnit","locateThatUnit","dir","set","reconfigurePixels","y","noRepeat","str","south","flag","north","west","east","south_west","south_east","north_west","north_east","get_neighbors","neighbors","get_cross","get_front","pixels","getImageData","data","getPixels","path","painted","layersManager","layersList","layers","delete","children","rebind","chooseLayer","createLayer","editLayer","Layer","zIndex","oldnamecopy","base_layer","layersCount","listObject","keys","layer","lastLayer","Layer 1","empty","embed","append","undefined","linkSignal","reverse","showCanvas","wrap","parent","unwrap","putImageData","framesManager","framesList","frames","map","chooseFrame","duplicateFrame","deleteFrame","attr","createFrame","contains","stopPropagation","currentFrame","editFrame","basicFrame","list","framesCount","toolbarSignal","frame","moveFrame","from_count","to_count","splice","reassignindexes","videoPreviewer","stopped","canvas2","stopPreview","currentFramelist","blankwindow","pause","play","interval","setInterval","fps","win","open","document","body","addClass","clearInterval","app","main_document","app_name","setSize","uni_width","previewer","toolbar","load","response","status","xhr","alert","statusText","dev"],"mappings":"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","file":"app.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export default class Tool {\n    constructor(name) {\n        this.name = name;\n        this.is_Acting = false;\n        this.manager = window.globalState.currentLayer.manager;\n    }\n\n    activateTool(event, startAction) {\n        startAction(event);\n        this.is_Acting = true;\n    }\n\n    invokeTool(event, invoke) {\n        if (window.globalState.currentTool) {\n            window.globalState.currentTool.suspendTool(event);\n        }\n        window.globalState.currentTool = this;\n        this.manager = window.globalState.currentLayer.manager;\n        if (invoke) {\n            invoke(event);\n        }\n    }\n\n    toolAction(event, intimeActions) {\n        if (this.is_Acting) {\n            intimeActions(event);\n        }\n    }\n\n    suspendTool(event, suspend) {\n        window.globalState.currentTool = null;\n        if (suspend) {\n            suspend(event);\n        }\n    }\n\n    deactivateTool(event, stopAction) {\n        this.is_Acting = false;\n        stopAction(event);\n    }\n}\n","import Tool from '../tool.js';\n\nexport default class Pen extends Tool {\n    constructor() {\n        super('pen');\n    }\n\n    clickAction() {\n        return true;\n    }\n\n    startAction(event) {\n        let context = this.manager.canvas.getContext('2d');\n        this.currentPath = new Path2D();\n        this.widthMod = this.widthMod = window.globalState.brushWidth;\n        this.paintColor = window.globalState.primaryColor;\n        context.fillStyle = this.paintColor;\n        context.beginPath();\n        let paintPoint = this.paintPoint(event);\n        paintPoint.paint(this.currentPath, this.widthMod * this.manager.unit_size, this.paintColor);\n        this.prevX = paintPoint.center_pixel.d_x;\n        this.prevY = paintPoint.center_pixel.d_y;\n        context.fill(this.currentPath);\n    }\n\n    paintPoint(event) {\n        return this.manager.getPointedUnit(event.pageX, event.pageY);\n    }\n\n    intimeActions(event) {\n        let paintPoint = this.paintPoint(event);\n        paintPoint.paint(this.currentPath, this.widthMod * this.manager.unit_size, this.paintColor);\n        this.prevX = paintPoint.d_x;\n        this.prevY = paintPoint.d_y;\n    }\n\n    stopAction() {\n        let context = this.manager.canvas.getContext('2d');\n        this.prevX = null; this.prevY = null;\n        context.closePath();\n    }\n\n    activateTool(event) {\n        return super.activateTool(event, this.startAction.bind(this));\n    }\n\n    toolAction(event) {\n        super.toolAction(event, this.intimeActions.bind(this));\n    }\n\n    deactivateTool(event) {\n        super.deactivateTool(event, this.stopAction.bind(this));\n    }\n\n    suspend() {\n        this.paintColor = null;\n        this.widthMod = null;\n    }\n\n    suspendTool(event) {\n        super.suspendTool(event, this.suspend.bind(this));\n    }\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// function setpixelated(context) {\n//     context['imageSmoothingEnabled'] = false;       /* standard */\n//     context['mozImageSmoothingEnabled'] = false;    /* Firefox */\n//     context['oImageSmoothingEnabled'] = false;      /* Opera */\n//     context['webkitImageSmoothingEnabled'] = false; /* Safari */\n//     context['msImageSmoothingEnabled'] = false;     /* IE */\n// }\n\n\n\n    // startAction(event) {\n\n    //     let context = this.manager.canvas.getContext('2d');\n    //     context.beginPath();\n    //     context.strokeStyle = 'blue';\n    //     context.fillStyle = 'blue';\n    //     let paintPoint = this.paintPoint(event);\n    //     paintPoint.paint();\n    //     this.prevX = paintPoint.center_pixel.d_x;\n    //     this.prevY = paintPoint.center_pixel.d_y;\n\n    //     console.log('Pen tool invoked succesfully...');\n    // }\n\n    // paintPoint(event) {\n    //     return this.manager.getPointedUnit(event.pageX, event.pageY);\n    // }\n\n    // intimeActions(event) {\n    //     let context = this.manager.canvas.getContext('2d');\n    //     context.lineWidth = this.widthMod * this.manager.unit_size;\n    //     let paintPoint = this.paintPoint(event).center_pixel;\n\n    //     moveTo(paintPoint.d_x, paintPoint.d_y);\n    //     if (this.prevY || this.prevX) {\n    //         context.lineTo(this.prevX, this.prevY);\n    //     }\n    //     context.stroke();\n    //     this.prevX = paintPoint.d_x;\n    //     this.prevY = paintPoint.d_y;\n    // }\n\n    // stopAction(event) {\n    //     let paintPoint = this.paintPoint(event);\n    //     paintPoint.paint();\n    //     this.prevX = null; this.prevY = null;\n    //     console.log('Pen tool suspended succesfully...');\n    // }\n","import Pen from \"../pen/index.js\";\n\nexport default class Eraser extends Pen {\n    constructor() {\n        super();\n        this.name = 'eraser';\n    }\n\n    startAction(event) {\n        this.manager.canvas.getContext('2d').globalCompositeOperation = 'destination-out';\n        super.startAction(event);\n    }\n\n    stopAction(event) {\n        super.stopAction(event);\n        this.manager.canvas.getContext('2d').globalCompositeOperation = 'source-over';\n    }\n\n}\n","import Tool from \"../tool.js\";\n\nexport default class Bucket extends Tool {\n  constructor() {\n    super('bucket');\n    this.clickAction = this.clickAction.bind(this);\n  }\n\n\n  async clickAction(event) {\n    let trampoline = fn => (...args) => {\n      let result = fn(...args)\n      while (typeof result === 'function') {\n        result = result()\n      }\n      return result\n    };\n    this.start = this.manager.getPointedUnit(event.pageX, event.pageY);\n    this.color = this.start.getColor();\n    function paint(x) {\n      x.paint(null, window.globalState.unit_size, window.globalState.secondaryColor);\n    }\n    paint(this.start);\n    function rec(plus, color, i) {\n      if (!plus.length) {\n        console.log(`Bucket suspended; array max size ${plus.length}`)\n        return;\n      }\n\n      if (plus.length > 2000) {\n        throw Error(`bad: ${plus.length}`);\n      }\n\n      plus = plus.reduce((acc, x) => { acc = addThatNotIn(acc, x.get_plus(1), color); return acc; }, []);\n\n      i++;\n      setTimeout(rec, 0, plus, color, i);\n    }\n\n    function addThatNotIn(arr1, arr2, color) {\n      arr2.forEach((x, i) => { if (inthe(arr1, x, i) === -1 && x.getColor() === color) { paint(x); arr1.push(x); } });\n      return arr1;\n    }\n\n    function inthe(arr, a, m) {\n      if (a === 'no_unit') {\n        return -2;\n      }\n      for (let i = m; i < arr.length; i++) {\n        if (arr[i].d_x === a.d_x && arr[i].d_y === a.d_y) {\n          return i;\n        }\n      }\n      return -1;\n    }\n\n    trampoline(rec)(Array.of(this.start), this.color, 0);\n  }\n\n\n  startAction() { return true; }\n\n  intimeActions() { return true; }\n\n  stopAction() { return true; }\n\n  toolAction() { return true; }\n\n  activateTool() { return true; }\n\n  deactivateTool() { return true; }\n}\n","export default class locator {\n  constructor() {\n  }\n\n  reactEvent(event) {\n    return window.globalState.currentLayer.manager.pointedUnit(event.pageX, event.pageY);\n  }\n\n  drawLocation(event) {\n    let XY = this.reactEvent(event);\n    $('#location_X').text(`${XY.unitX}`);\n    $('#location_Y').text(`${XY.unitY}`);\n  }\n\n  noLocation() {\n    $('#location_X').text(`-`);\n    $('#location_Y').text(`-`);\n  }\n}\n","import locator from \"./locator\";\n\nexport default class toolbarManager {\n  constructor(toolsObject) {\n    this.toolsObject = toolsObject;\n    window.globalState.currentTool = null;\n    this.locator = new locator();\n  }\n\n  start(updateView, updatePreview) {\n    $('.btn').mouseup(function () { this.blur() });\n    $('.workflow').on('mousemove', this.locator.drawLocation.bind(this.locator));\n    $('.workflow').on('mouseout', this.locator.noLocation.bind(this.locator));\n    $('.toolbar').on('click', this.delegate.bind(this));\n    this.signal = this.signal.bind(this);\n    this.update = updateView;\n    this.reload = updatePreview;\n  }\n\n  signal() {\n    this.tool = window.globalState.currentTool;\n    if (this.tool) {\n      this.tool.invokeTool();\n    }\n    let canvas = window.globalState.currentLayer.canvas;\n    $(canvas).off('click');\n    $(canvas).off('mousedown');\n    $(canvas).off('mousemove');\n    $(canvas).off('mouseup');\n    $(canvas).off('mouseout');\n    $(canvas).on('click', (e => { this.reload(); e.stopImmediatePropagation(); window.globalState.currentTool.clickAction(e); }));\n    $(canvas).on('mousedown', (e) => window.globalState.currentTool.activateTool(e));\n    $(canvas).on('mousemove', (e) => { this.reload(); window.globalState.currentTool.toolAction(e) });\n    $('.workflow').on('mousemove', this.locator.drawLocation.bind(this.locator));\n    $('.workflow').on('mouseout', this.locator.noLocation.bind(this.locator));\n    $(canvas).on('mouseup', (e) => { this.update(); window.globalState.currentTool.deactivateTool(e) });\n    $(canvas).on('mouseout', (e) => { this.update(); window.globalState.currentTool.deactivateTool(e) });\n  }\n\n  delegate(event) {\n    this.event = event;\n    this.tool = new this.toolsObject[event.target.getAttribute('tool')].prototype.constructor();\n\n    if (window.globalState.currentTool) {\n      $(this.tool.manager.canvas).off('click');\n      $(this.tool.manager.canvas).off('mousedown');\n      $(this.tool.manager.canvas).off('mousemove');\n      $(this.tool.manager.canvas).off('mouseup');\n      $(this.tool.manager.canvas).off('mouseout');\n      $('.toolbar .active').removeClass('active');\n      if (event.target.getAttribute('tool') === window.globalState.currentTool.name) {\n        window.globalState.currentTool.suspendTool(event);\n        return true;\n      }\n      window.globalState.currentTool.suspendTool(event);\n    }\n    event.target.classList.add('active');\n    this.tool.invokeTool(event);\n    $(this.tool.manager.canvas).on('click', (e => { this.reload(); e.stopImmediatePropagation(); window.globalState.currentTool.clickAction(e); }));\n    $(this.tool.manager.canvas).on('mousedown', (e) => window.globalState.currentTool.activateTool(e));\n    $(this.tool.manager.canvas).on('mousemove', (e) => { this.reload(); window.globalState.currentTool.toolAction(e) });\n    $(this.tool.manager.canvas).on('mouseup', (e) => { this.update(); window.globalState.currentTool.deactivateTool(e) });\n    $(this.tool.manager.canvas).on('mouseout', (e) => { this.update(); window.globalState.currentTool.deactivateTool(e) });\n    this.tool = null;\n  }\n\n\n}\n","export default class colorManager {\n  constructor(default_primary, default_secondary) {\n    window.globalState.primaryColor = default_primary;\n    window.globalState.secondaryColor = default_secondary;\n    this.default_primary = default_primary;\n    this.default_secondary = default_secondary;\n  }\n\n  start() {\n    $(\".colorbar [tool='primaryColor']\")[0].value = window.globalState.primaryColor;\n    $(\".colorbar [tool='secondaryColor']\")[0].value = window.globalState.secondaryColor;\n    $(\".colorbar [tool='primaryColor']\")[0].style.backgroundColor = window.globalState.primaryColor;\n    $(\".colorbar [tool='secondaryColor']\")[0].style.backgroundColor = window.globalState.secondaryColor;\n    $('.colorbar').on('input', this.delegate.bind(this));\n    $('.colorbar').on('click', this.delegate.bind(this));\n  }\n\n  delegate(event) {\n    if (event.target.getAttribute('tool') === 'swap_colors') {\n      let buf = window.globalState.secondaryColor;\n      window.globalState.secondaryColor = window.globalState.primaryColor;\n      window.globalState.primaryColor = buf;\n      $(\".colorbar [tool='primaryColor']\")[0].value = window.globalState.primaryColor;\n      $(\".colorbar [tool='primaryColor']\")[0].style.backgroundColor = window.globalState.primaryColor;\n      $(\".colorbar [tool='secondaryColor']\")[0].value = window.globalState.secondaryColor;\n      $(\".colorbar [tool='secondaryColor']\")[0].style.backgroundColor = window.globalState.secondaryColor;\n      return true;\n    }\n    window.globalState[event.target.getAttribute('tool')] = event.target.value;\n    event.target.style.backgroundColor = window.globalState[event.target.getAttribute('tool')];\n  }\n}\n","export default class brushbarManager {\n  constructor(default_width) {\n    this.default_width = default_width;\n    window.globalState.brushWidth = default_width;\n  }\n\n  start() {\n    $('#width-bar')[0].value = window.globalState.brushWidth;\n    $(\".brushbar output[for='width-bar']\").text(window.globalState.brushWidth);\n    $('#width-bar').on('input', this.update.bind(this));\n  }\n\n  update(event) {\n    clearTimeout(this.timeout);\n    window.globalState.brushWidth = event.target.value;\n    $(\".brushbar output[for='width-bar']\").text(window.globalState.brushWidth);\n    $(\".brushbar output[for='width-bar']\").css('left', ((window.globalState.brushWidth - 1) * 30.5) + '%');\n  }\n}\n","export default class Frame {\n  constructor(count, layerList) {\n    this.count = count;\n    this.layerList = layerList;\n  }\n\n  copy() {\n    return new Frame(this.count, this.layerList.copy());\n  }\n  html() {\n    let node = $(`<button class='frame btn btn-secondary rounded-0' style='padding: 0;'>\n    <span class='framecount'>${this.count}</span>${window.globalState.previewTemplate}\n    <a class='duplicateframe'><i class=\"fa fa-files-o\"></i></a>\n    <a class='deleteframe'><i class=\"fa fa-trash-o\"></i></a>\n    </button>`);\n    $('.frames-list').prepend(node);\n    this.layerList.preview(node.find('.preview.checked'));\n  }\n\n  preview(canvas) {\n    return this.layerList.redraw(canvas);\n  }\n}\n","\nexport default class canvasManager {\n  constructor(width, height, canvas) {\n\n    this.canvas = canvas;\n    this.unit_width = width;\n    this.unit_height = height;\n\n    this.constructCanvas();\n  }\n\n  constructCanvas() {\n    this.canvas.getContext('2d').fillStyle = '#ffffff00';\n    this.canvas.getContext('2d').fillRect(0, 0, this.canvas.width, this.canvas.height);\n    this.unit_size = this.canvas.width / this.unit_width;\n    window.globalState.unit_size = this.unit_size;\n  }\n\n  copy() {\n    let canvas = new $(window.globalState.canvasTemplate);\n    $('.workflow').prepend(canvas);\n    console.log($('.workflow canvas')[0]);\n    $('.workflow canvas')[0].getContext('2d').drawImage(this.canvas, 0, 0);\n    canvas = $('.workflow canvas')[0];\n    let manager = new canvasManager(this.unit_width, this.unit_height, canvas);\n    $('.workflow canvas').eq(0).remove();\n    return manager;\n  }\n\n  getCanvasPoint(pageX, pageY) {\n    let rect = this.canvas.getBoundingClientRect();\n    let canvasX;\n    let canvasY;\n    if (pageX >= rect.width + rect.left) {\n      canvasX = rect.width + rect.left;\n    } else if (pageX <= rect.left) {\n      canvasX = rect.left;\n    } else {\n      canvasX = pageX - rect.left;\n    }\n    if (pageY >= rect.height + rect.top) {\n      canvasY = rect.height + rect.top;\n    } else if (pageY <= rect.top) {\n      canvasY = rect.top;\n    } else {\n      canvasY = pageY - rect.top;\n    }\n    return { canvasX: canvasX, canvasY: canvasY };\n  }\n\n  findUnit(canvasX, canvasY) {\n    let unitX;\n    let unitY;\n    unitX = Math.floor(canvasX / this.unit_size);\n    unitY = Math.floor(canvasY / this.unit_size);\n    return { unitX: unitX, unitY: unitY };\n  }\n\n  pointedUnit(pageX, pageY) {\n    let XY = this.getCanvasPoint(pageX, pageY);\n    return this.findUnit(XY.canvasX, XY.canvasY);\n  }\n\n  getUnit(unitX, unitY) {\n    return new canvasUnit(this, unitX, unitY);\n  }\n\n  getPointedUnit(pageX, pageY) {\n    let XY = this.getCanvasPoint(pageX, pageY);\n    XY = this.findUnit(XY.canvasX, XY.canvasY);\n    return this.getUnit(XY.unitX, XY.unitY);\n  }\n\n  locateUnit(unitX, unitY) {\n    return { canvasX: unitX * this.unit_size, canvasY: unitY * this.unit_size };\n  }\n\n  locateThatUnit(canvasUnit) {\n    return this.locateUnit(canvasUnit.d_x, canvasUnit.d_y);\n  }\n}\n\nexport class canvasUnit {\n  constructor(canvasManager, unitX, unitY, dir) {\n    this.d_x = unitX;\n    this.d_y = unitY;\n    this.manager = canvasManager;\n    let XY = this.manager.locateUnit(this.d_x, this.d_y);\n    this.center_pixel = { d_x: XY.canvasX + (this.manager.unit_size / 2), d_y: XY.canvasY + (this.manager.unit_size / 2) };\n    Object.defineProperty(this, \"unitX\", { set: function (x) { this.reconfigurePixels(); this.unitX = x; } });\n    Object.defineProperty(this, \"unitY\", { set: function (y) { this.reconfigurePixels(); this.unitY = y; } });\n    this.reconfigurePixels();\n    this.dir = dir;\n  }\n\n  noRepeat(str) {\n    switch (str) {\n      case ('north'): return ['north', 'north_west', 'north_east', 'west', 'east'];\n      case ('south'): return ['south', 'south_west', 'south_east', 'west', 'east'];\n      case ('west'): return ['west', 'south_west', 'north_west', 'north', 'south'];\n      case ('east'): return ['east', 'south_east', 'north_east', 'north', 'south'];\n      case ('north_west'): return ['north', 'west'];\n      case ('south_east'): return ['south', 'east'];\n      case ('south_west'): return ['south', 'west'];\n      case ('north_east'): return ['north', 'east'];\n    }\n  }\n\n  south(i, flag) {\n    if (this.d_y - i < 0) {\n      return 'no_unit';\n    }\n    if (flag) {\n      return new canvasUnit(this.manager, this.d_x, this.d_y - i, 'south');\n    }\n    return new canvasUnit(this.manager, this.d_x, this.d_y - i, this.dir);\n  }\n\n  north(i, flag) {\n    if (this.d_y + i > this.manager.unit_height - 1) {\n      return 'no_unit';\n    }\n    if (flag) {\n      return new canvasUnit(this.manager, this.d_x, this.d_y + i, 'north');\n    }\n    return new canvasUnit(this.manager, this.d_x, this.d_y + i, this.dir);\n  }\n\n  west(i, flag) {\n    if (this.d_x - i < 0) {\n      return 'no_unit';\n    }\n    if (flag) {\n      return new canvasUnit(this.manager, this.d_x - i, this.d_y, 'west');\n    }\n    return new canvasUnit(this.manager, this.d_x - i, this.d_y, this.dir);\n  }\n\n  east(i, flag) {\n    if (this.d_x + i > this.manager.unit_width - 1) {\n      return 'no_unit';\n    }\n    if (flag) {\n      return new canvasUnit(this.manager, this.d_x + i, this.d_y, 'east');\n    }\n    return new canvasUnit(this.manager, this.d_x + i, this.d_y, this.dir);\n  }\n\n  south_west(i, flag) {\n    if (this.d_x - i < 0 || this.d_y - i < 0) {\n      return 'no_unit';\n    }\n    if (flag) {\n      return new canvasUnit(this.manager, this.d_x - i, this.d_y - i, 'south_west');\n    }\n    return new canvasUnit(this.manager, this.d_x - i, this.d_y - i, this.dir);\n  }\n\n  south_east(i, flag) {\n    if (this.d_x + i > this.manager.unit_width - 1 || this.d_y - i < 0) {\n      return 'no_unit';\n    }\n    if (flag) {\n      return new canvasUnit(this.manager, this.d_x + i, this.d_y - i, 'south_east');\n    }\n    return new canvasUnit(this.manager, this.d_x + i, this.d_y - i, this.dir);\n  }\n\n  north_west(i, flag) {\n    if (this.d_x - i < 0 || this.d_y + i > this.manager.unit_height - 1) {\n      return 'no_unit';\n    }\n    if (flag) {\n      return new canvasUnit(this.manager, this.d_x - i, this.d_y + i, 'north_west');\n    }\n    return new canvasUnit(this.manager, this.d_x - i, this.d_y + i, this.dir);\n  }\n\n  north_east(i, flag) {\n    if (this.d_x + i > this.manager.unit_width - 1 || this.d_y + i > this.manager.unit_height - 1) {\n      return 'no_unit';\n    }\n    if (flag) {\n      return new canvasUnit(this.manager, this.d_x + i, this.d_y + i, 'north_east');\n    }\n    return new canvasUnit(this.manager, this.d_x + i, this.d_y + i, this.dir);\n  }\n\n  get_neighbors(i) {\n    let neighbors = [];\n    neighbors.push(this.west(i), this.north_west(i), this.north(i), this.north_east(i));\n    neighbors.push(this.east(i), this.south_east(i), this.south(i), this.south_west(i));\n    return neighbors;\n  }\n\n  get_plus(i) {\n    if (this.dir) {\n      return this.noRepeat(this.dir).reduce((arr, x) => { arr.push(this[x](i)); return arr }, []);\n    }\n    let neighbors = [];\n    neighbors.push(this.west(i, 1), this.north(i, 1), this.east(i, 1), this.south(i, 1));\n    return neighbors;\n  }\n\n  get_cross(i) {\n    if (this.dir) {\n      return Array.of(this[this.dir](i));\n    }\n    let neighbors = [];\n    neighbors.push(this.north_west(i, 1), this.north_east(i, 1), this.south_east(i, 1), this.south_west(i, 1));\n\n    return neighbors;\n  }\n\n  get_front(i) {\n    return this[this.dir](i);\n  }\n\n  reconfigurePixels() {\n    let XY = this.manager.locateUnit(this.d_x, this.d_y);\n    this.pixels = this.manager.canvas.getContext('2d').getImageData(XY.canvasX, XY.canvasY, this.manager.unit_size, this.manager.unit_size);\n  }\n\n  getColor() {\n    let XY = this.manager.locateUnit(this.d_x, this.d_y);\n    this.pixels = this.manager.canvas.getContext('2d').getImageData(XY.canvasX, XY.canvasY, this.manager.unit_size, this.manager.unit_size);\n    let data = this.pixels.data;\n    if (data[3] < 255) {\n      return 'no_color';\n    }\n    return `${data[0]}${data[1]}${data[2]}`;\n  }\n\n  getPixels() {\n    return this.pixels;\n  }\n\n  paint(path, width, color) {\n    let XY = this.manager.locateUnit(this.d_x, this.d_y);\n    if (path === null) {\n      this.manager.canvas.getContext('2d').fillStyle = color;\n      this.manager.canvas.getContext('2d').rect(XY.canvasX, XY.canvasY, width, width);\n      this.manager.canvas.getContext('2d').fill();\n    } else {\n      path.rect(XY.canvasX, XY.canvasY, width, width);\n      this.manager.canvas.getContext('2d').fill(path);\n    }\n    this.painted = true;\n  }\n}\n","export default class layersManager {\n  constructor(layersList) {\n    this.layersList = layersList;\n  }\n\n  html() {\n    let str = this.layersList.layers().reduce((acc, x) => acc += x.html(), '');\n    return `${str}`;\n  }\n\n  delete() {\n    $('.layers-list').children().remove();\n  }\n\n  rebind() {\n    $('.layers-list').on('click', this.chooseLayer.bind(this));\n  }\n\n  bind() {\n    $('.layers-list').on('click', this.chooseLayer.bind(this));\n    $('button[tool=\"newlayer\"]').on('click', () => { this.layersList.createLayer(); });\n  }\n\n  chooseLayer(e) {\n    if ($(e.target).text() === window.globalState.currentLayer.name) {\n      return true;\n    }\n    this.layersList.editLayer($(e.target).text());\n    $('.layers-list .active').removeClass('active');\n    e.target.classList.add('active');\n  }\n}\n","export default class Layer {\n  constructor(name, canvasManager, zIndex) {\n    this.name = name;\n    this.manager = canvasManager;\n    this.zIndex = zIndex + 100;\n    this.canvas = this.manager.canvas;\n  }\n\n  copy() {\n    return new Layer(this.name + ' Copy', this.manager.copy(), this.zIndex + 1);\n  }\n  oldnamecopy() {\n    return new Layer(this.name, this.manager.copy(), this.zIndex + 1);\n  }\n\n  html() {\n    return `<button class='btn btn-secondary'>${this.name}</button>`;\n  }\n}\n","import canvasManager from '../../screens/canvas/Tools/canvasManager.js'\nimport layersManager from './layersManager.js';\nimport Layer from './Layer.js';\n\nexport default class layersList {\n  constructor(signal, base_layer, layersList) {\n    this.updateView = signal;\n    this.updateView = this.updateView.bind(this);\n    if (layersList) {\n      this.layersCount = 0;\n      this.layersManager = new layersManager(this);\n      this.listObject = Object.keys(layersList.listObject).reduce((acc, x) => {\n        let layer = layersList.listObject[x].oldnamecopy();\n        acc[layer.name] = layer;\n        return acc;\n      }, {});\n      this.layersManager.bind();\n      let keys = Object.keys(this.listObject);\n      this.lastLayer = this.listObject[keys[keys.length - 1]];\n      return;\n    }\n    if (base_layer) {\n      this.base_layer = base_layer;\n      this.layersManager = new layersManager(this);\n      this.listObject = { 'Layer 1': base_layer };\n      this.layersCount = 1;\n      window.globalState.currentLayer = base_layer;\n    }\n    else {\n      this.layersCount = 0;\n      this.layersManager = new layersManager(this);\n      this.listObject = {};\n      $('.workflow').empty();\n      this.createLayer('Layer 1');\n    }\n    this.layersManager.bind();\n  }\n\n  embed() {\n    this.layersManager.delete();\n    let html = this.layersManager.html();\n    $('.layers-list').append(html);\n    this.layersManager.rebind();\n  }\n\n  createLayer(name) {\n    if (this.listObject[name] !== undefined) {\n      throw new Error('Cannot create layer with name specified');\n    }\n    this.layersCount++;\n    let canvas = $(window.globalState.canvasTemplate);\n    canvas.css('zIndex', this.layersCount);\n    $('.workflow').append(canvas);\n\n    let manager = new canvasManager(window.globalState.unit_width, window.globalState.unit_height, canvas[0]);\n\n    if (!name) {\n      name = `Layer ${this.layersCount}`;\n    }\n    this.listObject[name] = new Layer(name, manager, this.layersCount);\n    window.globalState.currentLayer = this.listObject[name];\n    if (window.globalState.currentTool) {\n      this.updateView();\n    }\n    this.lastLayer = this.listObject[name];\n    this.embed();\n  }\n\n  editLayer(name) {\n    if (!name || this.listObject[name] === undefined) {\n      throw new Error('Cannot find layer with name specified');\n    }\n    window.globalState.currentLayer = this.listObject[name];\n    if (window.globalState.currentTool) {\n      this.updateView();\n    }\n    this.lastLayer = this.listObject[name];\n    this.embed();\n  }\n\n  linkSignal(signal) {\n    this.updateView = signal;\n    this.updateView = this.updateView.bind(this);\n  }\n\n  layers() {\n    return Object.keys(this.listObject).reduce((acc, x) => { acc.push(this.listObject[x]); return acc; }, []).reverse();\n  }\n\n  showCanvas() {\n    $('.workflow').empty();\n    Object.keys(this.listObject).forEach((x) => $('.workflow').append(this.listObject[x].canvas));\n    this.embed();\n  }\n\n  preview(canvas) {\n    Object.keys(this.listObject).reverse().forEach((x) => canvas[0].getContext('2d').drawImage(this.listObject[x].canvas, 0, 0));\n    let html = canvas.wrap('<p></p>').parent().html();\n    canvas.unwrap();\n    return html;\n  }\n\n  redraw(canvas) {\n    function getImageData(canvas) {\n      return canvas.getContext('2d').getImageData(0, 0, canvas.width, canvas.height);\n    }\n    Object.keys(this.listObject).reverse().forEach((x) => canvas[0].getContext('2d').putImageData(getImageData(this.listObject[x].canvas), 0, 0));\n    let html = canvas.wrap('<p></p>').parent().html();\n    canvas.unwrap();\n    return html;\n  }\n\n\n  copy() {\n    return new layersList(this.updateView, null, this);\n  }\n}\n","import layersList from \"./layersList.js\";\n\n// import './style.css'\n\nexport default layersList;\n","export default class framesManager {\n  constructor(framesList) {\n    this.framesList = framesList;\n  }\n\n  html() {\n    this.framesList.frames().map((x) => x.html());\n  }\n\n  delete() {\n    $('.frames-list').children().remove();\n  }\n\n  rebind() {\n    $('.frame').on('click', this.chooseFrame.bind(this));\n    $('.duplicateframe').on('click', (e) => {\n      this.framesList.duplicateFrame($(e.target).parent().parent().find('.framecount').text());\n    });\n    $('.deleteframe').on('click', (e) => {\n      this.framesList.deleteFrame($(e.target).parent().parent().find('.framecount').text());\n    });\n  }\n\n  bind() {\n    $('.frame').on('click', this.chooseFrame.bind(this));\n    $('.framesbar').on('click', (event) => {\n      if ($(event.target).attr('tool') === 'newframe') {\n        this.framesList.createFrame();\n      }\n    });\n  }\n\n  chooseFrame(e) {\n    if (e.target.classList.contains('preview')) {\n      e.target = $(e.target).parent()[0];\n    }\n    console.log(e.target);\n    if (e.target.classList.contains('btn')) {\n      e.stopPropagation();\n      let target = $(e.target).find('.framecount');\n      if (target.text() === window.globalState.currentFrame.count) {\n        return true;\n      }\n      this.framesList.editFrame.bind(this.framesList)(target.text());\n      $('.frames-list button.active').removeClass('active');\n      e.target.classList.add('active');\n      console.log(e.target.classList);\n    }\n  }\n}\n","import framesList from \"./framesList.js\";\n\n// import './style.css'\n\nexport default framesList;\n","\nimport Frame from './Frame.js';\nimport layersList from '../layers-list/index.js';\nimport framesManager from './framesManager.js'\n\nexport default class framesList {\n  constructor(basicFrame, manager) {\n    if (basicFrame && manager) {\n      this.basicFrame = basicFrame;\n      this.framesManager = manager;\n      this.list = Array.of(this.basicFrame);\n      this.framesCount = 1;\n      window.globalState.currentFrame = basicFrame;\n    } else {\n      this.framesCount = 0;\n      this.framesManager = new framesManager(this);\n      this.list = [];\n      this.update = this.update.bind(this);\n    }\n  }\n\n  start(toolbarSignal) {\n    this.signal = toolbarSignal;\n    this.createFrame();\n    this.framesManager.bind();\n  }\n\n  embed() {\n    this.framesManager.delete();\n    this.framesManager.html();\n    this.framesManager.rebind();\n    window.globalState.currentFrame.layerList.embed();\n  }\n\n  createFrame() {\n    let frame = new Frame(this.framesCount, new layersList(this.signal));\n\n    this.list.push(frame);\n    window.globalState.currentFrame = frame;\n    this.framesCount++;\n    this.embed();\n  }\n\n  editFrame(count) {\n    window.globalState.currentFrame = this.list[count];\n    window.globalState.currentFrame.layerList.showCanvas();\n    window.globalState.currentFrame.layerList.editLayer(window.globalState.currentFrame.layerList.lastLayer.name);\n    this.embed();\n  }\n\n  moveFrame(from_count, to_count) {\n    if (from_count >= this.list.length || to_count < 0 || from_count >= to_count) {\n      throw Error('Incorrect frame count input');\n    }\n    this.list[from_count].count = to_count;\n    this.list[to_count].count = from_count;\n    let buf = this.list[from_count];\n    this.list.splice(from_count, 1);\n    this.list.splice(to_count, 0, buf);\n    this.embed();\n  }\n\n  duplicateFrame(count) {\n\n    let frame = {};\n    frame = this.list[count].copy();\n    if (count === this.framesCount - 1) {\n      this.list.push(frame);\n      this.framesCount++;\n      this.reassignindexes();\n      this.embed();\n      return;\n    }\n\n    this.list.splice(count + 1, 0, frame);\n    this.framesCount++;\n    this.reassignindexes();\n    this.embed();\n  }\n\n  deleteFrame(count) {\n    if (this.framesCount > 1) {\n      let frame = this.list[count];\n      if (frame) {\n        if (window.globalState.currentFrame.count === count) {\n          if (count >= 1) {\n            window.globalState.currentFrame = this.list[count - 1];\n            this.list.splice(count, 1);\n            this.framesCount--;\n          }\n          else {\n            this.list.splice(count, 1);\n            window.globalState.currentFrame = this.list[this.framesCount--];\n          }\n        } else {\n          this.list.splice(count, 1);\n          this.framesCount--;\n        }\n        this.reassignindexes();\n        this.embed();\n      } else {\n        throw Error('Incorrect frame count input');\n      }\n\n    }\n  }\n\n  reassignindexes() {\n    this.list.forEach((x, i) => x.count = i);\n  }\n\n  update() {\n    this.embed();\n  }\n\n  frames() {\n    return this.list;\n  }\n}\n","export default class videoPreviewer {\n  constructor() {\n    this.frame = 0;\n    this.update = this.update.bind(this);\n    this.stopped = true;\n  }\n\n  async start() {\n    this.embed();\n  }\n\n  async updateView() {\n    this.frames[this.frame].preview(this.canvas);\n    if (this.canvas2 !== undefined) {\n      this.frames[this.frame].preview(this.canvas2);\n    }\n    if (this.frame === this.frames.length - 1) {\n\n      this.frame = 0;\n      return;\n    }\n    this.frame++;\n  }\n\n  async embed() {\n    this.stopPreview();\n    let canvas = $(window.globalState.previewTemplate);\n    $('.big_preview').prepend(canvas);\n    this.canvas = $('.big_preview canvas');\n    this.frames = window.globalState.currentFramelist.frames();\n    $('body .big_preview .fullpreview').on('click', this.blankwindow.bind(this));\n    $('body .big_preview .stopPreview').on('click', this.pause.bind(this));\n    $('body .big_preview .startPreview').on('click', this.play.bind(this));\n  }\n\n  async update() {\n    if (!this.stopped) {\n      this.stopPreview();\n      this.frames = window.globalState.currentFramelist.frames();\n      this.interval = setInterval(this.updateView.bind(this), 1000 / window.globalState.fps);\n    }\n  }\n\n  async play() {\n    this.stopped = false;\n    this.update();\n  }\n\n  async pause() {\n    this.stopped = true;\n    this.stopPreview();\n  }\n\n  async blankwindow() {\n    this.stopPreview();\n    let win = window.open('about:blank', 'Video preview');\n    $(win.document.body).append($(window.globalState.canvasTemplate));\n    this.canvas2 = $(win.document.body).find('canvas');\n    this.canvas2.addClass('fullscreen');\n    this.canvas2[0].style = `--w: 500px;\n    --i: ${window.globalState.unit_width};\n    width: 500px;\n    height: 500px;\n    background-color: #ffffff;\n    background-image: linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(135deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(135deg, transparent 75%, #ccc 75%);\n    background-size: calc(var(--w) /var(--i) * 2) calc(var(--w) /var(--i) * 2); /* Must be a square */\n    background-position: 0 0, calc(var(--w) /var(--i)) 0, calc(var(--w) /var(--i)) calc(var(--w) /var(--i) * -1), 0px calc(var(--w) /var(--i)); /* Must be half of one side of the square */\n    border: 1px solid #000000; `;\n    this.frames = window.globalState.currentFramelist.frames();\n    this.interval = setInterval(this.updateView.bind(this), 1000 / window.globalState.fps);\n  }\n\n  async stopPreview() {\n    clearInterval(this.interval);\n  }\n}\n","import PiskelApp from './app'\n\nlet app = new PiskelApp(32, 32, document);\n\n$(function () {\n  app.start();\n  app.dev();\n})\n\n","import { Pen, Eraser, Bucket, toolbarManager, colorManager, brushbarManager } from './screens/canvas/index.js'\n\nimport framesList from \"./components/frames-list/index.js\";\n\nimport videoPreviewer from \"./screens/preview/videoPreviewer.js\";\n\nexport default class PiskelApp {\n  constructor(unit_width, unit_height, main_document) {\n    window.globalState = {\n      app_name: 'PiskelClone',\n      canvasTemplate: '<canvas class=\"layer\" width= 640 height= 640></canvas>',\n      previewTemplate: '<canvas class=\"preview checked\" width= 500 height = 500></canvas>',\n      unit_width: unit_width,\n      unit_height: unit_height,\n      fps: 24,\n      main_document: main_document\n    };\n  }\n\n  setSize(uni_width, unit_height) {\n    window.globalState.unit_width = uni_width;\n    window.globalState.unit_height = unit_height;\n  }\n\n  start() {\n    window.globalState.currentFramelist = new framesList();\n\n    let previewer = new videoPreviewer();\n    previewer.start();\n\n    let toolsObject = {};\n    toolsObject['pen'] = Pen;\n    toolsObject['eraser'] = Eraser;\n    toolsObject['bucket'] = Bucket;\n\n    let toolbar = new toolbarManager(toolsObject);\n    toolbar.start(window.globalState.currentFramelist.update, previewer.update);\n    window.globalState.currentFramelist.start(toolbar.signal);\n\n    let colorbar = new colorManager('#000000', '#ff0000');\n    colorbar.start();\n\n    let brushbar = new brushbarManager(1);\n    brushbar.start();\n    $(':root').css('--i', window.globalState.unit_width);\n    $('#welcomescreen').load('./index.html', function (response, status, xhr) {\n\n      alert(status + xhr.status + \" \" + xhr.statusText);\n\n    });\n    $('.create').on('click', () => { this.setSize($('#width').value, $('#width').value) });\n\n  }\n\n  dev() {\n    $('body').on('keydown', (e) => { if (e.key === 'B') { window.globalState.currentFramelist.moveFrame(0, 1); } });\n  }\n}\n"],"sourceRoot":""}